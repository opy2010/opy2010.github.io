<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- 1. ç½‘ç«™æ ‡é¢˜ (Google æœç´¢ç»“æœçš„å¤§æ ‡é¢˜) -->
    <title>Global Alpha | ç¾è‚¡ä¸å®è§‚ç­–ç•¥åˆ†æ (Market Intelligence)</title>
    
    <!-- 2. ç½‘ç«™æè¿° (Google æœç´¢ç»“æœæ ‡é¢˜ä¸‹æ–¹çš„ä¸¤è¡Œå°å­—) -->
    <!-- âš ï¸ è¿™é‡Œéå¸¸é‡è¦ï¼Œè¦ç”¨ç®€çŸ­çš„è¯ä»‹ç»ä½ çš„ç½‘ç«™ä»·å€¼ -->
    <!-- SEO Meta Tags -->
    <meta name="description" content="Global Alpha uses top-tier AI to monitor global asset trends, providing daily US stock analysis, Buffett's value strategies, and actionable trading guides. åˆ©ç”¨é¡¶çº§äººå·¥æ™ºèƒ½å…¨å¤©å€™ç›‘æ§å…¨çƒèµ„äº§åŠ¨å‘ï¼Œæä¾›ç¾è‚¡å¤ç›˜ã€é‡åŒ–äº¤æ˜“ç­–ç•¥åŠæ¯æ—¥æ“ç›˜æ€»çº²ã€‚">
    <meta name="keywords" content="AI Investment, Market Intelligence, US Stocks, S&P 500, Nasdaq, Warren Buffett, Soros, Global Macro, Quantitative Trading, Financial Analysis, ç¾è‚¡åˆ†æ, äººå·¥æ™ºèƒ½æŠ•èµ„, é‡åŒ–äº¤æ˜“, å®è§‚ç»æµ, å·´è²ç‰¹, æ“ç›˜æŒ‡å—, èµ„äº§é…ç½®">
    <meta name="author" content="Global Alpha Research">




    <!-- Vue 3 & Tailwind -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <!-- Markdown è§£æåº“ -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <!-- æ ·å¼ä¿æŒä¸å˜ -->
    <style>
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        [v-cloak] { display: none; }
        .goog-te-banner-frame { display: none !important; }
        body { top: 0px !important; } 
        #google_translate_element select { border: 1px solid #cbd5e1; border-radius: 4px; padding: 2px; font-size: 11px; }
        .goog-logo-link { display: none !important; }
        .goog-te-gadget { color: transparent !important; }
        /* Markdown æ ·å¼è¡¥ä¸ */
        .markdown-body p { margin-bottom: 0.8em; line-height: 1.6; }
        .markdown-body strong { color: #0f172a; font-weight: 700; }
        .markdown-body ul { list-style-type: disc; padding-left: 1.2em; margin-bottom: 0.5em; }
        .markdown-body li { margin-bottom: 0.2em; }
        .markdown-body h1, .markdown-body h2, .markdown-body h3 { 
            font-weight: bold; margin-top: 1em; margin-bottom: 0.5em; color: #1e293b; 
        }
    </style>
</head>
<body class="bg-slate-50 font-sans min-h-screen text-slate-800">

<div id="app" v-cloak>
    
    <!-- 1. é¡¶éƒ¨ä¸»å¯¼èˆªæ  -->
    <nav class="bg-white shadow-sm sticky top-0 z-50 border-b border-slate-200">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between items-center h-16">
                <!-- Logo -->
                <div class="flex items-center cursor-pointer mr-8" @click="resetToHome">
                    <span class="text-3xl mr-2">ğŸ›ï¸</span>
                    <div>
                        <h1 class="text-xl font-bold tracking-tight text-slate-900 leading-none">GLOBAL</h1>
                        <span class="text-[10px] text-slate-500 font-bold tracking-widest">ALPHA</span>
                    </div>
                </div>

                <!-- æ¡Œé¢ç«¯èœå• -->
                <div class="hidden md:flex items-center flex-1">
                    
                    <!-- æ–°å¢ï¼šæ˜¾çœ¼çš„â€œæœ€æ–°åŠ¨æ€â€æŒ‰é’® -->
                    <button @click="resetToHome" 
                            :class="['px-3 py-2 text-sm font-bold mr-2 rounded transition', currentCategory === 'home' ? 'bg-slate-800 text-white' : 'text-slate-700 hover:bg-slate-100']">
                        {{ lang === 'zh' ? 'æœ€æ–°åŠ¨æ€' : 'Latest' }}
                    </button>
                    <!-- ğŸŸ¢ [æ–°å¢] ç¤¾åŒºå…¥å£æŒ‰é’® -->
                    <button @click="currentCategory = 'community'" 
                            :class="['px-3 py-2 text-sm font-bold mr-2 rounded transition flex items-center', currentCategory === 'community' ? 'bg-indigo-600 text-white' : 'text-indigo-600 hover:bg-indigo-50']">
                        <span class="mr-1">ğŸ’¬</span> {{ lang === 'zh' ? 'æŠ•èµ„è€…ç¤¾åŒº' : 'Community' }}
                    </button>

                    <!-- åˆ†ç±»ä¸‹æ‹‰èœå• -->
                    <div v-for="(menu, index) in menuStructure" :key="index" class="relative group px-3 py-2">
                        <button class="text-sm font-bold text-slate-700 hover:text-blue-600 flex items-center">
                            {{ lang === 'zh' ? menu.name_zh : menu.name_en }}
                            <svg class="w-3 h-3 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                        </button>
                        <!-- ä¸‹æ‹‰å†…å®¹ -->
                        <div class="absolute left-0 mt-2 w-48 bg-white rounded shadow-xl py-2 hidden group-hover:block border border-slate-100 z-50">
                            <a v-for="sub in menu.sub" @click="selectCategory(sub.id, sub.isStreamlit)"
                               class="block px-4 py-2 text-sm text-slate-600 hover:bg-blue-50 hover:text-blue-700 cursor-pointer">
                                {{ lang === 'zh' ? sub.name_zh : sub.name_en }}
                            </a>
                        </div>
                    </div>
                </div>

                <!-- å³ä¾§å·¥å…·æ  -->
                <div class="flex items-center space-x-3">
                    <button @click="toggleLang" class="px-2 py-1 bg-slate-100 border rounded text-xs font-bold hover:bg-slate-200">
                        {{ lang === 'zh' ? 'English/ä¸­æ–‡: CN' : 'English/ä¸­æ–‡: EN' }}
                    </button>
                    <div id="google_translate_element"></div>
                    <button @click="addToFavorite" class="bg-yellow-400 hover:bg-yellow-500 text-slate-900 px-3 py-1 rounded text-xs font-bold flex items-center">
                        â˜… {{ lang === 'zh' ? 'æ”¶è—' : 'Save' }}
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- 2. äºŒçº§ç­›é€‰æ  (ç±»ä¼¼è§†é¢‘ç½‘ç«™çš„ Tag åˆ—è¡¨) -->
    <!-- ä»…å½“ä¸åœ¨ Streamlit æ¨¡å¼ä¸”æœ‰å­èœå•æ—¶æ˜¾ç¤º -->
    <div v-if="!showStreamlit && currentCategory !== 'community'" class="bg-white border-b border-slate-200 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 py-3 flex flex-wrap items-center gap-2 overflow-x-auto no-scrollbar">
            <span class="text-xs font-bold text-slate-400 uppercase mr-2 shrink-0">
                {{ lang === 'zh' ? 'å¿«é€Ÿç­›é€‰:' : 'Filter:' }}
            </span>
            
            <!-- æ˜¾ç¤ºå½“å‰æ¿€æ´»çš„å¤§ç±»ä¸‹çš„å­ç±»ï¼Œæˆ–è€…æ˜¯å…¨éƒ¨çƒ­é—¨æ ‡ç­¾ -->
            <button 
                v-for="tag in activeTags"
                :key="tag.id"
                class="shrink-0 whitespace-nowrap px-3 py-1 text-xs rounded-full border transition"
                :key="tag.id"
                    @click="selectCategory(tag.id, tag.isStreamlit)"
                    :class="['px-3 py-1 text-xs rounded-full border transition whitespace-nowrap', 
                             currentCategory === tag.id 
                             ? 'bg-blue-600 text-white border-blue-600' 
                             : 'bg-white text-slate-600 border-slate-200 hover:border-blue-400 hover:text-blue-600']">
                {{ lang === 'zh' ? tag.name_zh : tag.name_en }}
            </button>
        </div>
    </div>

    <!-- 3. ä¸»ä½“å†…å®¹ -->
    <main class="max-w-7xl mx-auto px-4 py-6 flex gap-8">
        <!-- ğŸŸ¢ [æ–°å¢] ç¤¾åŒºèŠå¤©å®¤è§†å›¾ -->
        <div v-if="currentCategory === 'community'" class="w-full bg-white rounded-xl shadow-sm border border-slate-200 p-6 flex flex-col h-[800px]">
            <div class="border-b border-slate-100 pb-4 mb-4 flex justify-between items-center">
                <h2 class="text-2xl font-bold text-slate-800">{{ lang === 'zh' ? 'æŠ•èµ„è€…è®¨è®ºåŒº' : 'Investor Hub' }}</h2>
                <span class="text-sm text-slate-400">{{ comments.length }} Posts</span>
            </div>
            <!-- ç•™è¨€åˆ—è¡¨ -->
            <div class="flex-1 overflow-y-auto space-y-6 pr-2 mb-4">
                <div v-for="c in comments" :key="c.id" class="flex gap-4">
                    <div class="w-10 h-10 rounded-full flex items-center justify-center text-white font-bold shrink-0" 
                        :style="{ backgroundColor: stringToColor(c.user || 'G') }">{{ (c.user || 'G')[0].toUpperCase() }}</div>
                    <div>
                        <div class="flex items-center gap-2 mb-1">
                            <span class="font-bold text-slate-800">{{ c.user || 'Guest' }}</span>
                            <span class="text-xs text-slate-400">{{ new Date(c.timestamp?.seconds * 1000).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}) }}</span>
                        </div>
                        <div class="bg-slate-50 p-3 rounded-lg text-slate-700 text-sm border border-slate-100">{{ c.text }}</div>
                    </div>
                </div>
            </div>
            <!-- å‘é€åŒº -->
            <div class="border-t border-slate-100 pt-4">
                <input v-model="userNickname" class="w-1/3 border rounded px-3 py-2 text-sm mb-2" :placeholder="lang==='zh'?'æ‚¨çš„æ˜µç§°':'Nickname'">
                <div class="flex gap-2">
                    <textarea v-model="newComment" class="flex-1 border rounded px-3 py-2 text-sm h-20 resize-none" :placeholder="lang==='zh'?'å‘è¡¨çœ‹æ³•...':'Join discussion...'"></textarea>
                    <button @click="submitComment" class="bg-indigo-600 text-white px-6 rounded font-bold hover:bg-indigo-700">{{ lang==='zh'?'å‘å¸ƒ':'Post' }}</button>
                </div>
            </div>
        </div>

        <!-- ğŸŸ¢ [ä¿®æ”¹] ç»™åŸæ¥çš„æ–‡ç« åˆ—è¡¨å’Œä¾§è¾¹æ åŠ ä¸Š v-else -->
        <template v-else>
        <!-- å·¦ä¾§æ–‡ç« æµ -->
        <div class="flex-1">
            <div class="mb-4 flex items-end justify-between">
                <h2 class="text-xl font-bold text-slate-800 flex items-center">
                    <span class="mr-2 text-blue-600">|</span> 
                    {{ getCurrentCategoryTitle() }}
                </h2>
                <span v-if="loading" class="text-xs text-slate-400 animate-pulse">Data Syncing...</span>
            </div>

            <!-- Streamlit å®¹å™¨ -->
            <div v-if="showStreamlit" class="w-full h-[850px] bg-white rounded-xl shadow border border-slate-200 overflow-hidden relative">
                <iframe src="https://share.streamlit.io/" class="w-full h-full border-0 relative z-10"></iframe>
            </div>

        <div v-else>
          <!-- å®æ—¶æŠ¥ä»·è¡¨æ ¼ï¼ˆå½“ currentCategory å±äº live_* æ—¶æ˜¾ç¤ºï¼‰ -->
          <div v-if="currentCategory === 'live_global' || currentCategory === 'live_stocks' || currentCategory === 'live_indices'"
               class="bg-white rounded border p-4 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h3 class="font-bold">{{ lang==='zh'?'å®æ—¶æŠ¥ä»·ï¼ˆç›˜å/æ¯5åˆ†é’Ÿåˆ·æ–°ï¼‰':'Market Quotes (5min)' }}</h3>
              <div class="text-sm text-slate-500">Last updated: {{ lastUpdateStr }}</div>
            </div>

            <div class="overflow-auto">
              <table class="min-w-full text-sm">
                <thead>
                  <tr class="text-left text-xs text-slate-500">
                    <th class="px-2 py-2">Symbol</th>
                    <th class="px-2 py-2">Name</th>
                    <th class="px-2 py-2">Price</th>
                    <th class="px-2 py-2">Change</th>
                    <th class="px-2 py-2">Change %</th>
                    <th class="px-2 py-2">Source</th>
                  </tr>
                </thead>
                <tbody>
                  <tr v-for="row in displayedRows" :key="row.symbol" class="border-t">
                    <td class="px-2 py-2 font-mono">{{ row.symbol }}</td>
                    <td class="px-2 py-2">{{ row.name }}</td>
                    <td class="px-2 py-2 font-mono">{{ formatNumber(row.price) }}</td>
                    <td class="px-2 py-2">
                      <span :class="row.change >= 0 ? 'text-rose-600' : 'text-emerald-600'">{{ formatNumber(row.change) }}</span>
                    </td>
                    <td class="px-2 py-2">
                      <span :class="row.change_pct >= 0 ? 'text-rose-600' : 'text-emerald-600'">{{ formatNumber(row.change_pct) }}%</span>
                    </td>
                    <td class="px-2 py-2 text-xs text-slate-400">{{ row.source }}</td>
                  </tr>
                  <tr v-if="displayedRows.length === 0">
                    <td colspan="6" class="px-2 py-4 text-center text-slate-400">No data</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
            <!-- æ–‡ç« åˆ—è¡¨ -->
            <div v-else class="space-y-4">
                <div v-if="posts.length === 0 && !loading" class="text-center py-12 bg-white rounded border border-slate-100">
                    <p class="text-slate-400 text-sm">æš‚æ— æ•°æ® / No Data</p>
                </div>

                <article v-for="post in posts" :key="post.id" class="bg-white rounded border border-slate-200 p-5 hover:shadow-md transition duration-200">
                    <div class="flex justify-between items-start mb-2">
                        <div class="flex items-center gap-2">
                            <span class="px-2 py-0.5 bg-slate-100 text-slate-600 text-[10px] font-bold uppercase rounded">
                                {{ post.subcategory || 'NEWS' }}
                            </span>
                            <span class="text-[10px] text-slate-400 font-mono">
                                {{ formatDateTime(post.timestamp) }}
                            </span>
                        </div>
                    </div>
                    
                    <!-- åŒè¯­æ ‡é¢˜ -->
                    <h3 class="text-lg font-bold text-slate-900 mb-2 cursor-pointer hover:text-blue-700">
                        {{ lang === 'zh' ? post.title_zh : post.title_en }}
                    </h3>
                    
                    <!-- åŒè¯­å†…å®¹ -->
                    <div class="text-slate-600 text-sm leading-relaxed markdown-body" 
                        v-html="renderMarkdown(lang === 'zh' ? post.content_zh : post.content_en)">
                    </div>
                </article>
            </div>
        </div>

        <!-- å³ä¾§è¾¹æ  -->
        <aside class="hidden lg:block w-72 space-y-6">
            <!-- ç•™è¨€æ¿ -->
            <div class="bg-white rounded shadow-sm border border-slate-200 p-4">
                <h3 class="font-bold text-slate-800 mb-3 text-sm border-b pb-2">
                    {{ lang === 'zh' ? 'ç•™è¨€æ¿' : 'Comments' }}
                </h3>
                <div class="h-48 overflow-y-auto no-scrollbar space-y-2 mb-3 bg-slate-50 p-2 rounded">
                    <div v-for="c in comments" :key="c.id" class="text-xs border-b border-slate-100 last:border-0 pb-1">
                        <span class="font-bold text-slate-700">Guest:</span> 
                        <span class="text-slate-600">{{ c.text }}</span>
                    </div>
                </div>
                <div class="flex gap-1">
                    <input v-model="newComment" class="flex-1 text-xs border p-1 rounded focus:outline-none" :placeholder="lang==='zh'?'è¯´ç‚¹ä»€ä¹ˆ...':'Type here...'">
                    <button @click="submitComment" class="bg-slate-800 text-white text-xs px-2 rounded hover:bg-slate-700">Go</button>
                </div>
            </div>

            <!-- ç»Ÿè®¡ -->
            <div class="bg-slate-50 rounded p-4 text-center border border-slate-100">
                <span class="text-xs text-slate-400 uppercase">Total Views</span>
                <div class="text-xl font-mono text-slate-800 mt-1" id="busuanzi_container_site_pv">
                    <span id="busuanzi_value_site_pv">--</span>
                </div>
            </div>
        </aside>
    </template>
    </main>
<!-- ================= SEO æ ¸å¿ƒå†…å®¹åŒº (ä¸å½±å“åŠŸèƒ½ï¼Œåªå¢åŠ æ”¶å½•) ================= -->
    <section class="bg-white border-t border-slate-200 mt-12 py-12">
        <div class="max-w-7xl mx-auto px-4">
            
            <!-- è‹±æ–‡ä»‹ç»æ¿å— -->
            <div class="mb-12">
                <h2 class="text-2xl font-bold text-slate-900 mb-4">ğŸš€ About Global Alpha: AI-Driven Market Intelligence</h2>
                <div class="grid md:grid-cols-2 gap-8 text-slate-600 leading-relaxed text-sm">
                    <div>
                        <p class="mb-4">
                            <strong>Global Alpha</strong> is a premier financial research platform that leverages cutting-edge <strong>Artificial Intelligence (AI)</strong> and Large Language Models to monitor global asset movements 24/7. We bridge the gap between institutional-grade quantitative analysis and individual investing by processing vast amounts of data from the <strong>US Stock Market (NYSE, NASDAQ)</strong>, Asian Markets, and Commodities.
                        </p>
                        <p>
                            Our system generates an unbiased <strong>Daily Executive Brief</strong>, analyzing market sentiment, volatility indexes (VIX), and Federal Reserve policies. We focus on high-growth sectors including Artificial Intelligence (Nvidia, Microsoft), Semiconductors, and SaaS, while hedging risks through Gold and Treasury Bonds analysis.
                        </p>
                    </div>
                    <div>
                        <h3 class="font-bold text-slate-800 mb-2">Core Investment Strategies:</h3>
                        <ul class="list-disc pl-5 space-y-1">
                            <li><strong>Master's Wisdom:</strong> Replicating the strategies of legends like <strong>Warren Buffett (Value)</strong>, George Soros (Reflexivity), and Jesse Livermore (Trend Following).</li>
                            <li><strong>Quantitative Signals:</strong> Algo-trading alerts based on Momentum, Mean Reversion, and Volume Profile analysis.</li>
                            <li><strong>Global Macro:</strong> Deep dive into CPI/PPI inflation data, Interest Rates, and Geopolitical impacts on asset prices.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- ä¸­æ–‡ä»‹ç»æ¿å— (å¢åŠ ä¸­æ–‡æœç´¢æƒé‡) -->
            <div class="border-t border-slate-100 pt-10">
                <h2 class="text-2xl font-bold text-slate-900 mb-4">ğŸš€ å¹³å°ç®€ä»‹ï¼šå…¨çƒèµ„äº§åŠ¨å‘ä¸ AI æ“ç›˜ç³»ç»Ÿ</h2>
                <div class="grid md:grid-cols-2 gap-8 text-slate-600 leading-relaxed text-sm">
                    <div>
                        <p class="mb-4">
                            <strong>Global Alpha</strong> æ˜¯ä¸€ä¸ªå‰æ²¿çš„é‡‘èç ”ç©¶å¹³å°ï¼Œè‡´åŠ›äºåˆ©ç”¨<strong>é¡¶çº§äººå·¥æ™ºèƒ½ï¼ˆAIï¼‰</strong>æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œå…¨å¤©å€™ç›‘æ§å…¨çƒèµ„æœ¬å¸‚åœºåŠ¨å‘ã€‚æˆ‘ä»¬æ‰“ç ´æœºæ„ä¸æ•£æˆ·ä¹‹é—´çš„ä¿¡æ¯å·®ï¼Œé€šè¿‡ç®—æ³•ä¸ºæ‚¨æä¾›æœ€ç†æ€§çš„å¸‚åœºåˆ†æä¸<strong>é‡åŒ–äº¤æ˜“ç­–ç•¥</strong>ã€‚
                        </p>
                        <p>
                            æˆ‘ä»¬çš„ç³»ç»Ÿå®æ—¶èšåˆ<strong>ç¾è‚¡ï¼ˆçº³æ–¯è¾¾å…‹ã€æ ‡æ™®500ï¼‰</strong>ã€æ¸¯Aè‚¡åŠå¤§å®—å•†å“æ•°æ®ã€‚ç»“åˆ<strong>å·´è²ç‰¹ï¼ˆä»·å€¼æŠ•èµ„ï¼‰ã€ç´¢ç½—æ–¯ï¼ˆåèº«æ€§ç†è®ºï¼‰ä¸åˆ©å¼—è«å°”ï¼ˆè¶‹åŠ¿äº¤æ˜“ï¼‰</strong>çš„å¤§å¸ˆæ™ºæ…§ï¼Œç”Ÿæˆå…·æœ‰å®æˆ˜ä»·å€¼çš„<strong>æ¯æ—¥æ“ç›˜æ€»çº²</strong>ï¼Œæ˜ç¡®æç¤ºå¤šç©ºæ–¹å‘ä¸é£æ§ç‚¹ä½ã€‚
                        </p>
                    </div>
                    <div>
                        <h3 class="font-bold text-slate-800 mb-2">æ ¸å¿ƒè¦†ç›–é¢†åŸŸï¼š</h3>
                        <ul class="list-disc pl-5 space-y-1">
                            <li><strong>ç¾è‚¡æ·±åº¦å¤ç›˜ï¼š</strong> é‡ç‚¹è¿½è¸ªç§‘æŠ€ä¸ƒå·¨å¤´ï¼ˆMagnificent 7ï¼‰ã€AI äº§ä¸šé“¾ã€èŠ¯ç‰‡åŠå¯¼ä½“åŠ SaaS æ¿å—çš„æœºæ„èµ„é‡‘æµå‘ã€‚</li>
                            <li><strong>å®è§‚ç»æµå¯¹å†²ï¼š</strong> è§£è¯»ç¾è”å‚¨åŠ æ¯é™æ¯è·¯å¾„ã€å›½å€ºæ”¶ç›Šç‡æ›²çº¿ã€é»„é‡‘ä¸åŸæ²¹çš„é¿é™©é€»è¾‘ã€‚</li>
                            <li><strong>æ™ºèƒ½é‡åŒ–é£æ§ï¼š</strong> åŸºäºæ³¢åŠ¨ç‡ä¸åŠ¨é‡å› å­çš„è‡ªåŠ¨é¢„è­¦ç³»ç»Ÿï¼Œå¸®åŠ©æŠ•èµ„è€…åœ¨åŠ¨è¡å¸‚åœºä¸­ä¿æŒç†æ€§ã€‚</li>
                        </ul>
                    </div>
                </div>
            </div>

        </div>
    </section>
    <!-- ================= SEO å†…å®¹ç»“æŸ ================= -->
    <footer class="text-center text-slate-400 text-xs py-8 border-t mt-8">
        &copy; 2025 Global Markets Analysis.
    </footer>
</div>

<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'en', layout: google.translate.TranslateElement.InlineLayout.SIMPLE, autoDisplay: false}, 'google_translate_element');
}
</script>
<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, addDoc, serverTimestamp, query, orderBy, limit, getDocs } 
        from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    // 1. Firebase é…ç½® (ä¿ç•™ï¼Œç”¨äºè¯„è®ºåŒº)
    const firebaseConfig = {
        apiKey: "AIzaSyDoMl3klw1FTdbj4tbgxLRshlowMfLN-M0",
        authDomain: "goog8-f3754.firebaseapp.com",
        projectId: "goog8-f3754",
        storageBucket: "goog8-f3754.firebasestorage.app",
        messagingSenderId: "1017507222346",
        appId: "1:1017507222346:web:a2fbc8617eca9cf80aa7b3"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    // âŒ åˆ é™¤äº† enableIndexedDbPersistenceï¼Œå› ä¸ºå®ƒå¯èƒ½å¯¼è‡´ç™½å±å´©æºƒ

    const { createApp, ref, computed, onMounted } = Vue;

    createApp({
        setup() {
            // ================= çŠ¶æ€å˜é‡ =================
            const savedLang = localStorage.getItem("lang") || "zh";
            const lang = ref(savedLang);



            const currentCategory = ref('home');
            const showStreamlit = ref(false);
            const posts = ref([]);      // å½“å‰æ˜¾ç¤ºçš„æ–‡ç« åˆ—è¡¨
            const allPosts = ref([]);   // ğŸŸ¢ æ ¸å¿ƒï¼šå­˜æ”¾æ‰€æœ‰ä¸‹è½½çš„æ–‡ç« ç¼“å­˜
            const comments = ref([]);
            const loading = ref(true);
            const newComment = ref('');
            const userNickname = ref('');
            // === è¡Œæƒ…æ•°æ®å­˜æ”¾ï¼ˆæ¥è‡ª Firebaseï¼‰ ===
            const quotes = ref([]);       // å­˜è¡Œæƒ…è¡¨æ ¼æ•°æ®
            const lastUpdate = ref(null); // è¡Œæƒ…æ•°æ®æ›´æ–°æ—¶é—´

            // === è¡Œæƒ…è¡¨æ ¼æ•°æ®ï¼ˆå½“å‰ä¸‰ä¸ªæ ç›®å…±ç”¨ï¼‰ ===
            const displayedRows = computed(() => {
                if (
                    currentCategory.value === "live_global" ||
                    currentCategory.value === "live_stocks" ||
                    currentCategory.value === "live_indices"
                ) {
                    return quotes.value; // è¡Œæƒ…è¡¨æ ¼ä½¿ç”¨ quotes
                }
                return []; // éè¡Œæƒ…æ ç›®è¿”å›ç©º
            });


            // å®Œæ•´çš„èœå•ç»“æ„ (ç”¨äºç”Ÿæˆé¡¶éƒ¨å’ŒäºŒçº§å¯¼èˆª)
            const menuStructure = [
            {
                name_zh: "æ“ç›˜æŒ‡å—",
                name_en: "Daily Guide",
                sub: [
                    { id: "market_guide", name_zh: "ğŸ”¥ æ¯æ—¥æ€»çº²", name_en: "Executive Brief" },
                    { id: "news_analysis", name_zh: "ğŸ“° æ–°é—»è§£æ", name_en: "News Analysis" },     // â† æ–°å¢
                    { id: "stock_insights", name_zh: "ğŸ“ˆ ä¸ªè‚¡åˆ†æ", name_en: "Stock Insights" }  // â† æ–°å¢
                ]
            },
            {
                name_zh: "å…¨çƒå¸‚åœº",
                name_en: "Global Markets",
                sub: [
                    { id: "us_analysis", name_zh: "ğŸ‡ºğŸ‡¸ ç¾è‚¡åˆ†æ", name_en: "US Market" },
                    { id: "asia_market", name_zh: "ğŸ‡¨ğŸ‡³ğŸ‡¯ğŸ‡µ äºšå¤ªå¸‚åœº", name_en: "Asia" },
                    { id: "global_indices", name_zh: "ğŸŒ ä¸–ç•ŒæŒ‡æ•°", name_en: "World Indices" }
                ]
            },
            {
                name_zh: "èµ„äº§ç±»åˆ«",
                name_en: "Assets",
                sub: [
                    { id: "commodities", name_zh: "ğŸ›¢ï¸ åŸæ²¹/é»„é‡‘", name_en: "Oil & Gold" },
                    { id: "macro_fed", name_zh: "ğŸ›ï¸ å®è§‚/å›½å€º", name_en: "Macro & Bonds" },
                ]
            },
            {
                name_zh: "å®æ—¶æŠ¥ä»·",               // â† æ–°å¢ä¸»æ ç›®
                name_en: "Live Markets",
                sub: [
                    { id: "live_global", name_zh: "ğŸŒ å…¨çƒè¡Œæƒ…", name_en: "Global Assets" },
                    { id: "live_stocks", name_zh: "ğŸ”¥ é¾™å¤´è‚¡æŠ¥ä»·", name_en: "Leaders" },
                    { id: "live_indices", name_zh: "ğŸ“Š ä¸–ç•ŒæŒ‡æ•°", name_en: "Indices" }
                ]
            },
            {
                name_zh: "å¤§å¸ˆæ™ºæ…§",
                name_en: "Master's Wisdom",
                sub: [
                    { id: "buffett", name_zh: "å·´è²ç‰¹ (ä»·å€¼)", name_en: "Buffett" },
                    { id: "soros", name_zh: "ç´¢ç½—æ–¯ (åèº«æ€§)", name_en: "Soros" },
                    { id: "livermore", name_zh: "åˆ©å¼—è«å°” (è¶‹åŠ¿)", name_en: "Livermore" },
                    { id: "wu_chaohui", name_zh: "ä¼æœè¾‰ (ä¸»åŠ›)", name_en: "Wu" },
                    { id: "gann", name_zh: "æ±Ÿæ© (æ—¶ç©º)", name_en: "Gann" }
                ]
            }
        ];


            // ================= æ ¸å¿ƒé€»è¾‘ =================

            // ğŸŸ¢ 1. åŠ è½½é™æ€æ–‡ä»¶ (è¿™æ˜¯æœ€å…³é”®çš„ä¿®æ”¹)
            const loadAllPosts = async () => {
                loading.value = true;
                try {
                    console.log("ğŸ“¥ å¼€å§‹ä¸‹è½½ posts.json ...");
                    // åŠ æ—¶é—´æˆ³é˜²æ­¢ç¼“å­˜
                    const res = await fetch(`posts.json?t=${new Date().getTime()}`);
                    
                    if (!res.ok) throw new Error(`æ–‡ä»¶ä¸‹è½½å¤±è´¥: ${res.status}`);
                    
                    const data = await res.json();
                    allPosts.value = data;
                    console.log(`âœ… æˆåŠŸåŠ è½½ ${data.length} ç¯‡æ–‡ç« `);
                    
                    // åˆå§‹æ˜¾ç¤ºé¦–é¡µ
                    filterPosts('home');
                    
                } catch (e) {
                    console.error("åŠ è½½é”™è¯¯:", e);
                    posts.value = []; // å³ä½¿å¤±è´¥ä¹Ÿä¸è¦å´©æºƒ
                } finally {
                    loading.value = false;
                }
            };

            // ğŸŸ¢ 2. çº¯å‰ç«¯ç­›é€‰ (é€Ÿåº¦æå¿«)
            const filterPosts = (catId) => {
                if (catId === 'home') {
                    // é¦–é¡µæ˜¾ç¤ºæœ€æ–°çš„ 20 æ¡
                    posts.value = allPosts.value.slice(0, 20);
                } else {
                    // æŒ‰åˆ†ç±» ID ç­›é€‰
                    posts.value = allPosts.value.filter(p => p.category === catId);
                }
            };
            // === ä» Firestore è¯»å–è¡Œæƒ…æ•°æ®ï¼ˆå‰ç«¯åªè¯»ï¼Œä¸æŠ“å–å¤–éƒ¨ APIï¼‰ ===
            const loadQuotesFromFirebase = async () => {
            try {
                console.log("loadQuotesFromFirebase start");
                // è¿™é‡Œå‡è®¾ä½ çš„é›†åˆåä¸º "market_quotes"ï¼›å¦‚ä¸åŒè¯·æ›¿æ¢
                const q = query(collection(db, "market_quotes"));
                const snap = await getDocs(q);

                const rows = snap.docs.map(d => {
                const data = d.data();
                return {
                    symbol: data.symbol || d.id,
                    name: data.name || data.symbol || d.id,
                    price: data.price ?? null,
                    change: data.change ?? null,
                    change_pct: data.change_pct ?? null,
                    source: data.source || 'db',
                    last_update: data.last_update || Date.now()
                };
                });

                quotes.value = rows;
                lastUpdate.value = rows.length ? rows[0].last_update || Date.now() : Date.now();
                console.log("loadQuotesFromFirebase done, rows:", quotes.value.length);
            } catch (e) {
                console.error("loadQuotesFromFirebase error:", e);
                quotes.value = [];
                lastUpdate.value = null;
            }
            };

                        // æ–°å¢æˆ–æ›¿æ¢ï¼šç®€å•åŠ è½½æ–°é—»ï¼ˆå…¼å®¹å…è´¹å±‚ï¼Œæ— éœ€å¤åˆç´¢å¼•ï¼‰
            const loadNewsSimple = async () => {
                try {
                    loading.value = true;
                    // åªæŒ‰æ—¶é—´å€’åºè¯»å–æœ€è¿‘ 200 æ¡ï¼ˆå…è´¹å±‚æ”¯æŒï¼‰
                    const q = query(
                        collection(db, "posts"),
                        orderBy("timestamp", "desc"),
                        limit(200)  // å¤Ÿç”¨äº†ï¼Œä½ åªæœ‰å‡ ç™¾æ¡
                    );
                    const snap = await getDocs(q);
                    
                    // å‰ç«¯æ‰‹åŠ¨è¿‡æ»¤ category
                    const filtered = snap.docs
                        .map(doc => {
                            const data = doc.data();
                            return {
                                id: doc.id,
                                title_zh: data.title_zh || data.title_en || "æ— æ ‡é¢˜",
                                title_en: data.title_en || data.title_zh || "No Title",
                                content_zh: data.content_zh || "",
                                content_en: data.content_en || "",
                                category: data.category || "",
                                subcategory: data.subcategory || "",
                                timestamp: data.timestamp ? data.timestamp.toDate() : new Date()
                            };
                        })
                        .filter(post => post.category === "news_analysis");  // åªä¿ç•™æ–°é—»

                    posts.value = filtered;  // ç›´æ¥èµ‹å€¼ç»™ posts æ˜¾ç¤º
                    console.log(`âœ… ç®€å•åŠ è½½æ–°é—»æˆåŠŸï¼š${filtered.length} æ¡`);
                } catch (e) {
                    console.error("åŠ è½½æ–°é—»å¤±è´¥:", e);
                    posts.value = [];
                } finally {
                    loading.value = false;
                }
            };

            // ğŸŸ¢ 3. åˆ‡æ¢åˆ†ç±»
            const selectCategory = async (catId, isStreamlit = false) => {
            console.log("selectCategory", catId);
            currentCategory.value = catId;
            showStreamlit.value = isStreamlit;

            // ç‚¹å‡»è¡Œæƒ…æ ç›® â€” åªä»æ•°æ®åº“è¯»å–å¹¶å±•ç¤º
            if (catId === "live_global" || catId === "live_stocks" || catId === "live_indices") {
                // åªæ‹‰å–æ•°æ®åº“æ•°æ®ï¼ˆå‰ç«¯åªè¯»ï¼‰ï¼Œé¿å…æ¯ä¸ªç”¨æˆ·å»è°ƒç”¨ç¬¬ä¸‰æ–¹ API
                loadQuotesFromFirebase();
                return;
            }
        // ã€å…³é”®ã€‘æ–°é—»åˆ†ææ ç›®ï¼šä» Firebase åŠ è½½
            // åœ¨ selectCategory å‡½æ•°å†…
            if (catId === "news_analysis") {
                await loadNewsSimple();  // ä½¿ç”¨ç®€å•åŠ è½½
                return;
            }
            if (catId !== "community" && !isStreamlit) filterPosts(catId);
            };


            // ================= è¾…åŠ©å‡½æ•° =================
            
            const activeTags = computed(() => {
            // ä¸€ç›´è¿”å›å…¨éƒ¨å­æ ç›®ï¼ˆæ‰å¹³åŒ–ï¼‰
            let all = [];
            menuStructure.forEach(m => { all = all.concat(m.sub); });
            return all;
            });


            const getCurrentCategoryTitle = () => {
                if (currentCategory.value === 'home') return lang.value === 'zh' ? 'æœ€æ–°åŠ¨æ€' : 'Latest Updates';
                for (const group of menuStructure) {
                    const found = group.sub.find(s => s.id === currentCategory.value);
                    if (found) return lang.value === 'zh' ? found.name_zh : found.name_en;
                }
                return 'Analysis';
            };

            // è¯„è®ºç›¸å…³ (ä¿æŒ Firebase)
            const fetchComments = async () => {
                try {
                    const q = query(collection(db, "guest_comments"), orderBy("timestamp", "desc"), limit(50));
                    const snap = await getDocs(q);
                    comments.value = snap.docs.map(doc => doc.data());
                } catch(e) { console.error("è¯„è®ºåŠ è½½å¤±è´¥", e); }
            };

            const submitComment = async () => {
                if(!newComment.value.trim()) return;
                const name = userNickname.value.trim() || "Guest Investor";
                localStorage.setItem('userNickname', name);
                await addDoc(collection(db, "guest_comments"), {
                    text: newComment.value, user: name, timestamp: serverTimestamp()
                });
                newComment.value = "";
                fetchComments();
            };


            // å·¥å…·å‡½æ•°
            // const toggleLang = () => { lang.value = lang.value === 'zh' ? 'en' : 'zh'; };
            const toggleLang = () => {
                lang.value = lang.value === "zh" ? "en" : "zh";
                localStorage.setItem("lang", lang.value);
            };
            const resetToHome = () => { selectCategory('home'); };
            const addToFavorite = () => { alert("Ctrl+D to bookmark"); };
            const formatDateTime = (ts) => {
                if (!ts) return '';
                // å…¼å®¹å­—ç¬¦ä¸²æ—¶é—´
                const date = typeof ts === 'string' ? new Date(ts) : new Date(ts.seconds * 1000);
                return date.toLocaleString('en-US', { month:'numeric', day:'numeric', hour:'2-digit', minute:'2-digit', hour12:false });
            };
            const stringToColor = (str) => {
                let hash = 0;
                for (let i = 0; i < str.length; i++) { hash = str.charCodeAt(i) + ((hash << 5) - hash); }
                const c = (hash & 0x00FFFFFF).toString(16).toUpperCase();
                return '#' + '00000'.substring(0, 6 - c.length) + c;
            };
            const renderMarkdown = (text) => {
                if (!text) return '';
                try { return marked.parse(text); } catch (e) { return text; }
            };

            // ================= åˆå§‹åŒ– =================
            onMounted(() => { 
                loadAllPosts();  // ğŸŸ¢ å¯åŠ¨æ—¶åŠ è½½ JSON
                fetchComments(); // åŠ è½½è¯„è®º
                const cached = localStorage.getItem('userNickname');
                if(cached) userNickname.value = cached;
            });

            return {
                lang, menuStructure, currentCategory, showStreamlit, posts, comments, loading, newComment, activeTags, userNickname,
                toggleLang, resetToHome, addToFavorite, selectCategory, getCurrentCategoryTitle, submitComment, formatDateTime, 
                renderMarkdown, stringToColor,
                displayedRows,
                lastUpdate,
                lastUpdateStr: computed(() => lastUpdate.value ? new Date(lastUpdate.value).toLocaleString() : "--"),
                formatNumber: (v) => (v === null || v === undefined ? "--" : Number(v).toFixed(2)),

            };
        }
    }).mount('#app');
</script>
</body>
</html>