<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GOOGL Sniper Signal | Real-time Analysis</title>
    <meta name="description" content="real-time GOOGL & QQQ trading signals">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/milligram/1.4.1/milligram.min.css">
    <style>
        body { max-width: 960px; margin: 40px auto; padding: 20px; line-height: 1.8; font-family: system-ui, sans-serif; }
        .header { text-align: center; padding: 30px 0; border-bottom: 1px solid #eee; }
        .lang-menu { position: fixed; top: 15px; right: 15px; z-index: 9999; background: white; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.15); overflow: hidden; }
        .lang-current { padding: 10px 16px; cursor: pointer; background: #f8f9fa; font-weight: bold; }
        .lang-current::after { content: " ▼"; font-size: 0.8em; }
        .lang-options { display: none; background: white; max-height: 60vh; overflow-y: auto; }
        .lang-options a { display: block; padding: 12px 16px; text-decoration: none; color: #333; }
        .lang-options a:hover { background: #e3f2fd; }
        .lang-menu:hover .lang-options { display: block; }
        .footer { text-align: center; padding: 50px 0; color: #666; font-size: 0.9em; border-top: 1px solid #eee; margin-top: 60px; }
        #ad-top, #ad-bottom { text-align: center; margin: 30px 0; }
    </style>
</head>
<body>

<!-- 精美语言菜单 -->
<div class="lang-menu">
    <div class="lang-current" onclick="this.nextElementSibling.style.display=(this.nextElementSibling.style.display==='block'?'none':'block')">
        English
    </div>
    <div class="lang-options">
        <a href="#" onclick="translate('en'); return false;">English</a>
        <a href="#" onclick="translate('zh-CN'); return false;">中文 (简体)</a>
        <a href="#" onclick="translate('zh-TW'); return false;">中文 (繁體)</a>
        <a href="#" onclick="translate('ja'); return false;">日本語</a>
        <a href="#" onclick="translate('ko'); return false;">한국어</a>
        <a href="#" onclick="translate('es'); return false;">Español</a>
        <a href="#" onclick="translate('ru'); return false;">Русский</a>
        <a href="#" onclick="translate('ar'); return false;">العربية</a>
        <a href="#" onclick="translate('hi'); return false;">हिन्दी</a>
        <a href="#" onclick="translate('pt'); return false;">Português</a>
        <a href="#" onclick="translate('fr'); return false;">Français</a>
        <a href="#" onclick="translate('de'); return false;">Deutsch</a>
        <!-- 可继续加 100+ 语言 -->
    </div>
</div>

<div class="header">
    <h1>GOOGL Sniper Signal</h1>
    <p id="update-date">Update: Loading...</p>
</div>

<div id="ad-top"></div>
<div id="content"><p>Loading latest analysis...</p></div>
<div id="ad-bottom"></div>

<div class="footer">
    © 2025 goog8.top • Quant Research • Not investment advice
</div>

<!-- Google Translate 核心 -->
<div id="google_translate_element"></div>

<script type="text/javascript">
// 1. 初始化 Google 翻译
function googleTranslateElementInit() {
    new google.translate.TranslateElement({
        pageLanguage: 'en',
        // 删除 layout: SIMPLE，改用默认布局，这样 <select> 才会一直存在
        autoDisplay: false
    }, 'google_translate_element');
}

// 2. 执行翻译的函数 (修复版)
function translate(lang) {
    // 获取 Google 翻译生成的隐藏下拉框
    const select = document.querySelector('.goog-te-combo');
    
    // 如果还没加载好，稍微等一下再试（容错机制）
    if (!select) {
        console.warn("Google Translate widget not ready yet.");
        return;
    }

    // 更新界面显示的语言名称
    const names = {
        'en': 'English', 'zh-CN': '中文 (简体)', 'zh-TW': '中文 (繁體)', 
        'ja': '日本語', 'ko': '한국어', 'es': 'Español', 'ru': 'Русский', 
        'ar': 'العربية', 'hi': 'हिन्दी', 'pt': 'Português', 'fr': 'Français', 'de': 'Deutsch'
    };
    const langName = names[lang] || lang;
    document.querySelector('.lang-current').innerText = langName;
    document.querySelector('.lang-menu').querySelector('.lang-options').style.display = 'none'; // 点击后关闭菜单

    // --- 核心修改：触发 Google 翻译 ---
    // 必须同时改变 value 并触发 change 事件
    select.value = lang;
    select.dispatchEvent(new Event('change')); 
    
    // 某些浏览器可能需要 input 事件
    select.dispatchEvent(new Event('input'));

    // 保存偏好
    localStorage.setItem('preferredLang', lang);
}

// 3. 页面加载后恢复用户上次选择
window.addEventListener('load', () => {
    // 稍微延迟执行，确保 Google 组件已经渲染完成
    setTimeout(() => {
        const saved = localStorage.getItem('preferredLang');
        if (saved && saved !== 'en') {
            translate(saved);
        }
    }, 1000); // 延迟 1 秒，等待 Google JS 加载
});
</script>
<script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<!-- 加载内容和广告 -->
<script>
    fetch('ads/top.html').then(r=>r.text()).then(t=>document.getElementById('ad-top').innerHTML=t).catch(()=>{});
    fetch('ads/bottom.html').then(r=>r.text()).then(t=>document.getElementById('ad-bottom').innerHTML=t).catch(()=>{});
    
    // 加载 content.js 并显示
    fetch('content.js?t=' + Date.now())
        .then(r => r.text())
        .then(js => {
            eval(js);
            if (typeof DATA_EN !== 'undefined') {
                document.getElementById('content').innerHTML = DATA_EN.content;
                document.getElementById('update-date').innerText = 'Update: ' + DATA_EN.updateDate;
            }
        })
        .catch(e => console.error(e));
</script>
</body>
</html>
